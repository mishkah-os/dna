# ๐งฌ SIREN Pattern Mining System - ุงูุฏููู ุงูุดุงูู

<div dir="rtl">

## ๐ฏ ุงูููุฑุฉ ุงูุซูุฑูุฉ

### ุงููุดููุฉ ูุน ุงูุทุฑู ุงูุชูููุฏูุฉ

**SVD ูุทุฑู ุงูุถุบุท ุงูุชูููุฏูุฉ:**
- ุชุนุงูู ุงูุฃูุฒุงู ูุฃุฑูุงู ุนุดูุงุฆูุฉ ูุฌุจ ุถุบุทูุง
- ุชููุฏ ุงูุจููุฉ ุงูููุฏุณูุฉ ููุฃูุฒุงู
- ุชุญุชุงุฌ ุฅุนุงุฏุฉ ุชุฏุฑูุจ (fine-tuning) ูุงุณุชุนุงุฏุฉ ุงูุฃุฏุงุก
- ูุณุจุฉ ุถุบุท ุซุงุจุชุฉุ ูุง ูุฑููุฉ

**ููุฌูุง ุงูุฌุฏูุฏ: SIREN Pattern Mining**
- ูุนุงูู ุงูุฃูุฒุงู ูู **ุฅุดุงุฑุฉ ูุณุชูุฑุฉ** ุนูู **ุณุทุญ ููุฏุณู** (manifold)
- ูุชุนูู **ุงูุฏุงูุฉ ุงูุฑูุงุถูุฉ** ุงูุชู ุชููุฏ ูุฐู ุงูุฃูุฒุงู
- ููุชุดู **ุงูุฃููุงุท ุงููุฎููุฉ** ูู ุจููุฉ ุงูุดุจูุฉ
- ูุณุชุทูุน ุชูููุฏ ุฃูุฒุงู ุจุฃู ุฏูุฉ (infinite resolution)

## ๐ฌ ุงููุจุฏุฃ ุงูุนููู

### 1. ุงูุฃูุฒุงู ูููุงุท ุนูู Manifold

ูู ูุฒู `W[i,j]` ูู ุงูุทุจูุฉ `L` ููุณ ุฑููุงู ูุนุฒููุงูุ ุจู:
- ูู **ุฅุญุฏุงุซูุงุช** ูู ูุถุงุก 4D: `(x, y, z, type)`
  - `x`: ูููุน ุงูุตู (Row) ููุณูู ุฅูู [-1, 1]
  - `y`: ูููุน ุงูุนููุฏ (Col) ููุณูู ุฅูู [-1, 1]
  - `z`: ุฑูู ุงูุทุจูุฉ (Layer) ููุณูู ุฅูู [-1, 1]
  - `type`: ููุน ุงููุฒู (Query/Key/Value/FFN)

- ูู **ูููุฉ** ูุญุฏุฏุฉ ุจุฏุงูุฉ ูุณุชูุฑุฉ: `f(x, y, z, type) = W[i,j]`

### 2. SIREN: ุงูุดุจูุฉ ุงูุชู ุชุชุนูู ุงูุฏุงูุฉ

**SIREN = Sinusoidal Representation Network**

ุจุฏูุงู ูู ReLUุ ูุณุชุฎุฏู `sin(ฯยทx)`:

```python
# ุงูุดุจูุฉ ุงูุนุงุฏูุฉ (ุชูุดู ูู ุงูุชูุงุตูู ุงูุฏูููุฉ)
x = ReLU(Wโยทx + bโ)
x = ReLU(Wโยทx + bโ)

# SIREN (ุชูุชูุท ุงูุชูุงุตูู ุงูุฏูููุฉ)
x = sin(ฯยท(Wโยทx + bโ))
x = sin(ฯยท(Wโยทx + bโ))
```

**ููุงุฐุง sinุ**
- ุชุณุชุทูุน ุชูุซูู ุชุฑุฏุฏุงุช ุนุงููุฉ (high frequencies)
- ูุดุชูุงุชูุง ุฏูุฑูุฉ ููุณุชูุฑุฉ (smooth gradients)
- ุชุณุชุทูุน ุชุนูู ุฃููุงุท ููุฌูุฉ ูุนูุฏุฉ

### 3. ุงูุชุฏุฑูุจ = ุงูุชุดุงู ุงูููุท

```python
# ููุณ ุชุฏุฑูุจุงู ุชูููุฏูุงู ููุดุจูุฉ ุนูู ุจูุงูุงุช
for epoch in epochs:
    for (coords, target_weight) in dataset:
        predicted = DNA(coords)  # ุชูููุฏ ุงููุฒู ูู ุงูุฅุญุฏุงุซูุงุช
        loss = MSE(predicted, target_weight)  # ูู ูุฎุชูู ุนู ุงููุฒู ุงูุญููููุ
        loss.backward()  # ุชุญุฏูุซ ุงูู DNA ูุชุญุณูู ุงูุชุทุงุจู
```

**ุงููุชูุฌุฉ:** DNA ุงูุขู ูุญุชูู ุนูู "ุงููุนุงุฏูุฉ" ุงูุชู ุชููุฏ ุฌููุน ุงูุฃูุฒุงู!

## ๐ฆ ุงูุจููุฉ ุงููุนูุงุฑูุฉ

### 1. SpectralDNA (ุงูุฃุณุงุณู)

```python
Input: (x, y, z, type) โ โโด
    โ
SineLayerโ: sin(ฯโ ยท Linear(input))
    โ
SineLayerโ: sin(ฯโ ยท Linear(x))
    โ
SineLayerโ: sin(ฯโ ยท Linear(x))
    โ
LinearFinal: Linear(x) โ weight_value
```

**ุงูุญุฌู:** ~256 hidden ร 5 layers = ~650K parameters
**ููููุฏ:** 14.5M weights (ุถุบุท ~22x)

### 2. HierarchicalSpectralDNA (ูุชูุฏู)

ูุชุนูู ุงูุฃููุงุท ุนูู **ุซูุงุซุฉ ูุณุชููุงุช**:

```python
Low Frequency DNA (ฯ/4):  ุงูุจููุฉ ุงูุนุงูุฉ
    โ
Mid Frequency DNA (ฯ):    ุงูุฃููุงุท ุงููุญููุฉ
    โ
High Frequency DNA (4ฯ):  ุงูุชูุงุตูู ุงูุฏูููุฉ
    โ
Weighted Combination โ Final Weight
```

**ุงูููุฒุฉ:** ููุตู ุงูุฃููุงุท ุงููุจูุฑุฉ ุนู ุงูุตุบูุฑุฉุ ุฃุณูู ููุชุญููู

### 3. AdaptiveSpectralDNA (ุงูุฃูุซุฑ ุฐูุงุกู)

```python
omega_predictor(coords) โ ฯ_local  # ุชุฑุฏุฏ ูุฎุชูู ููู ููุทูุฉ
    โ
sin(ฯ_local ยท Linear(coords)) โ weight
```

**ุงูููุฑุฉ:** ุจุนุถ ุงูููุงุทู ุชุญุชุงุฌ ุชุฑุฏุฏุงุช ุนุงููุฉ (Attention QKV)ุ ูุจุนุถูุง ุชุฑุฏุฏุงุช ููุฎูุถุฉ (Biases)

## ๐จ ูุธุงู Visualization ุงููุชูุฏู

### 1. Weight Manifold 3D

```python
visualizer.visualize_weight_manifold_3d(coords, values)
```

**ูุงุฐุง ุณุชุฑู:**
- ููุงุท ุซูุงุซูุฉ ุงูุฃุจุนุงุฏ (x, y, z) ููููุฉ ุญุณุจ ูููุฉ ุงููุฒู
- ูุซุงูุฉ ุงูุชูุฒูุน ูู ูู ููุทูุฉ
- ุชูุฒูุน ุงูููู ุญุณุจ ุงูุทุจูุงุช

**ุงูุชูุณูุฑ:**
- ุฅุฐุง ุฑุฃูุช **ุชุฌูุนุงุช** (clusters) โ ุงูุฃูุฒุงู ููุณุช ุนุดูุงุฆูุฉุ ููุงู ุฃููุงุท!
- ุฅุฐุง ุฑุฃูุช **ุงูุชุธุงู** (regularity) โ ุงูุจููุฉ ููุฏุณูุฉ ููุธูุฉ
- ุฅุฐุง ุฑุฃูุช **ุชุฏุฑุฌ** (gradient) โ ุงูุฃููุงุท ุชุชุบูุฑ ุจุณูุงุณุฉ

### 2. Spectral Analysis (FFT)

```python
visualizer.visualize_spectral_content(coords, values)
```

**ูุงุฐุง ุณุชุฑู:**
- FFT 2D ููู ุทุจูุฉ
- ุงูุชุฑุฏุฏุงุช ุงูููุฌูุฏุฉ ูู ุงูุฃูุฒุงู

**ุงูุชูุณูุฑ:**
- **ุทุงูุฉ ูู ุงููุฑูุฒ** (low freq) โ ุฃููุงุท ูุจูุฑุฉุ ุณูุณุฉ
- **ุทุงูุฉ ูู ุงูุฃุทุฑุงู** (high freq) โ ุชูุงุตูู ุฏูููุฉุ ุชุบูุฑุงุช ุณุฑูุนุฉ
- **ุจูุน ูุถูุฆุฉ** โ ุชุฑุฏุฏุงุช ูููููุฉ (ุฑุจูุง ุฃููุงุท ุฏูุฑูุฉ!)

### 3. Pattern Clustering (t-SNE)

```python
visualizer.visualize_pattern_clustering(coords, values)
```

**ูุงุฐุง ุณุชุฑู:**
- ููุงุท ูู 2Dุ ูู ููุทุฉ = ูุฒู ูุงุญุฏ
- ุงูุฃููุงู = ุงููููุฉ ุฃู ุงูุทุจูุฉ

**ุงูุชูุณูุฑ:**
- **ุชุฌูุนุงุช ูููุตูุฉ** โ ุฃููุงุน ูุฎุชููุฉ ูู ุงูุฃูุฒุงู (Attention vs FFN)
- **ุชุฌูุนุงุช ูุชุฏุงุฎูุฉ** โ ุงูุฃููุงุท ูุดุชุฑูุฉ ุจูู ุงูุทุจูุงุช
- **ุฎุทูุท/ููุญููุงุช** โ ุงูุจููุฉ ุฎุทูุฉ ุฃู ุดุจู ุฎุทูุฉ

### 4. Reconstruction Quality

```python
metrics = visualizer.visualize_reconstruction_quality(
    original_values,
    reconstructed_values
)
```

**9 ุฑุณูู ุจูุงููุฉ:**
1. **Scatter**: ุฃุตูู vs ููุนุงุฏ (ูุฌุจ ุฃู ุชููู ุฎุท ูุณุชููู)
2. **Error Distribution**: ูู ุงูุฃุฎุทุงุก ุทุจูุนูุฉุ (Gaussian)
3. **Absolute Error**: ูู ุงูุฎุทุฃ ุงูุฅุฌูุงููุ
4. **Error vs Magnitude**: ูู ุงูุฃูุฒุงู ุงููุจูุฑุฉ ุฃุตุนุจุ
5. **Layer-wise Error**: ุฃู ุทุจูุฉ ุงูุฃุตุนุจุ
6. **Cumulative Error**: ูู ูุณุจุฉ ุงูุฃูุฒุงู ุฏูููุฉุ
7. **Q-Q Plot**: ูู ุงูุชูุฒูุน ุทุจูุนูุ
8. **Hexbin Density**: ูุซุงูุฉ ุงูููุงุท
9. **Statistics Table**: ุฌููุน ุงูุฃุฑูุงู

## ๐ ููู ุชุณุชุฎุฏูู

### ุงูุชุซุจูุช

```bash
cd /home/user/dna

# ุชุซุจูุช ุงููุชุทูุจุงุช (ุฅุฐุง ูู ุชูู ูุซุจุชุฉ)
pip install -r requirements.txt

# ุงูุชุฃูุฏ ูู ุฃู ูู ุดูุก ูุนูู
python src/dna/siren.py  # ุงุฎุชุจุงุฑ SIREN
python src/dna/weight_dataset.py  # ุงุฎุชุจุงุฑ Dataset
```

### ุงูุชุดุบูู ุงููุงูู

```bash
# ุฎูุงุฑ 1: ุชุดุบูู ุจุงูุฅุนุฏุงุฏุงุช ุงูุงูุชุฑุงุถูุฉ
python scripts/run_pattern_mining.py

# ุฎูุงุฑ 2: ุชุฎุตูุต ุงูุฅุนุฏุงุฏุงุช
python scripts/run_pattern_mining.py \
    --model huawei-noah/TinyBERT_General_4L_312D \
    --dna-type hierarchical \
    --hidden-dim 256 \
    --num-layers 5 \
    --epochs 100 \
    --batch-size 8192 \
    --learning-rate 1e-4 \
    --output-dir ./my_mining_results

# ุฎูุงุฑ 3: ุชุตูุฑ ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ ููุท
python scripts/run_pattern_mining.py \
    --visualize-only \
    --output-dir ./my_mining_results
```

### ุงููุฎุฑุฌุงุช ุงููุชููุนุฉ

```
my_mining_results/
โโโ checkpoints/
โ   โโโ best_model.pt              # ุฃูุถู DNA ูุฏุฑุจ
โ   โโโ checkpoint_epoch_10.pt
โ   โโโ training_history.json
โโโ data/
โ   โโโ weight_dataset.pt          # Dataset ุงููุงูู
โ   โโโ metadata.json              # ูุนูููุงุช ุงูููุฏูู
โโโ visualizations/
โ   โโโ raw_weights/
โ   โ   โโโ weight_manifold_3d.png
โ   โ   โโโ spectral_analysis.png
โ   โ   โโโ pattern_clustering.png
โ   โโโ reconstruction/
โ       โโโ reconstruction_quality.png
โ       โโโ weight_manifold_3d.png
โโโ summary.json                   # ููุฎุต ุดุงูู
โโโ logs/
    โโโ pattern_mining_*.log
```

### ูุฑุงุกุฉ ุงููุชุงุฆุฌ

**1. ุงูุชุญ `summary.json`:**

```json
{
  "original_parameters": 14500000,
  "dna_parameters": 650000,
  "compression_ratio": 22.31,
  "reconstruction_metrics": {
    "r2": 0.956,        // > 0.9 ููุชุงุฒ
    "mse": 0.0023,      // < 0.01 ุฌูุฏ ุฌุฏุงู
    "psnr": 36.4        // > 30 dB ุฌูุฏ
  }
}
```

**2. ุงูุชุญ ุงูุตูุฑ ูู `visualizations/`:**
- ุงุจุฏุฃ ุจู `raw_weights/` ูุชุฑู ุงูุจูุงูุงุช ุงูุฃุตููุฉ
- ุซู `reconstruction/` ูุชุฑู ุฌูุฏุฉ ุฅุนุงุฏุฉ ุงูุจูุงุก

**3. ุงูุญุต training_history.json:**
- ูู ุงูู loss ุงูุฎูุถุ (ูุฌุจ ุฃู ูุตู < 0.01)
- ูู ุงูู PSNR ุงุฑุชูุนุ (ูุฌุจ > 30 dB)

## ๐งช ุฃูุซูุฉ ุชุญููููุฉ

### ูุซุงู 1: ุงูุชุดุงู ุฃู Attention Layers ูุชุดุงุจูุฉ

```python
# ุจุนุฏ ุงูุชุฏุฑูุจุ ุงูุญุต ุงูู DNA
dna = torch.load("checkpoints/best_model.pt")

# ูููุฏ ุฃูุฒุงู ูุทุจูุงุช ูุฎุชููุฉ ุจููุณ (x,y) ููู z ูุฎุชูู
coords_layer0 = torch.tensor([[0.5, 0.3, -0.8, 0.0]])  # Layer 0
coords_layer3 = torch.tensor([[0.5, 0.3,  0.8, 0.0]])  # Layer 3

w0 = dna(coords_layer0)
w3 = dna(coords_layer3)

similarity = F.cosine_similarity(w0, w3)
print(f"ุชุดุงุจู ุงูุฃูุฒุงู ุจูู ุงูุทุจูุชูู: {similarity:.2f}")
# ุฅุฐุง > 0.8 โ ุงูุทุจูุงุช ุชุชุดุงุฑู ุฃููุงุทุงู ูุดุชุฑูุฉ!
```

### ูุซุงู 2: ุงูุชุดุงู ุชุฑุฏุฏุงุช ูููููุฉ

```python
# ุงูุชุญ spectral_analysis.png
# ุงุจุญุซ ุนู "ููุงุท ูุถูุฆุฉ" ูู FFT

# ุฅุฐุง ุฑุฃูุช ููุทุงู ุดุจููุงู (grid pattern) โ
# ุงูุฃูุฒุงู ุฏูุฑูุฉ! ุฑุจูุง ููุงู ุชูุงุซู (symmetry)

# ุฅุฐุง ุฑุฃูุช ุฎุทูุทุงู ูุทุฑูุฉ โ
# ุงูุฃูุฒุงู ูุฑุชุจุทุฉ ุจูู ุงูุตููู ูุงูุฃุนูุฏุฉ
```

### ูุซุงู 3: ููุงุฑูุฉ Query vs Key vs Value

```python
# ูู pattern_clustering.png (t-SNE colored by type)
# ุงุจุญุซ ุนู:
# - ูู Q/K/V ูู ุชุฌูุนุงุช ูููุตูุฉุ โ ูุธุงุฆู ูุฎุชููุฉ
# - ูู Q ู K ูุฑูุจุงูุ โ ุฑุจูุง ูุชุดุงุฑูุงู ุจููุฉ (ููุง ูู ุงูุฃุจุญุงุซ!)
# - ูู V ุจุนูุฏุฉุ โ ุฑุจูุง ููุง ุฏูุฑ ูุฎุชูู
```

## ๐ ุงููุชุงุฆุฌ ุงููุชููุนุฉ

### ููู TinyBERT (14.5M params)

| ุงููููุงุณ | ุงููููุฉ ุงููุชููุนุฉ | ุงูุชูุณูุฑ |
|---------|-----------------|----------|
| **Compression Ratio** | 15-25x | DNA ุฃุตุบุฑ 20 ูุฑุฉ ุชูุฑูุจุงู |
| **Rยฒ** | 0.90-0.97 | 90-97% ูู ุงูุชุจุงูู ูููุณููุฑ |
| **PSNR** | 30-40 dB | ุฌูุฏุฉ ููุชุงุฒุฉ |
| **Training Time** | 2-4 ุณุงุนุงุช | ุนูู GPU ูุงุญุฏ |
| **Reconstruction MSE** | < 0.01 | ุฎุทุฃ ุตุบูุฑ ุฌุฏุงู |

### ูุงุฐุง ุชุชููุน ุฃู ุชุฑู ูู ุงูุตูุฑ

**1. Weight Manifold 3D:**
- **ุชุฌูุนุงุช ูุงุถุญุฉ** ุญุณุจ ุงูุทุจูุฉ (z-axis)
- **ุชูุฒูุน ููุชุธู** ูู x,y (ููุณ ุนุดูุงุฆูุงู)
- **ุฃููุงู ูุชุฏุฑุฌุฉ** (ุงูุฃูุฒุงู ุชุชุบูุฑ ุจุณูุงุณุฉ)

**2. Spectral Analysis:**
- **ุทุงูุฉ ุฃุนูู ูู ุงูุชุฑุฏุฏุงุช ุงูููุฎูุถุฉ** (ุงููุฑูุฒ)
- **ุจุนุถ ุงูุชุฑุฏุฏุงุช ุงูุนุงููุฉ** (ุงูุชูุงุตูู)
- **ุงุฎุชูุงู ุจูู ุงูุทุจูุงุช** (ูู ุทุจูุฉ ููุง ุชุฑุฏุฏูุง)

**3. t-SNE:**
- **3-4 ุชุฌูุนุงุช ุฑุฆูุณูุฉ** (Attention, FFN, Embeddings)
- **ุจุนุถ ุงูุชุฏุงุฎู** (ุงูุฃููุงุท ุงููุดุชุฑูุฉ)
- **ุชุฏุฑุฌ ุญุณุจ ุงูุทุจูุฉ** (ูู ุงูุฃููู ููุฃุฎูุฑุฉ)

## ๐ ุงูุฎูุงุตุฉ ุงูุนูููุฉ

### ูุง ุชุนูููุงู

1. **ุงูุฃูุฒุงู ููุณุช ุนุดูุงุฆูุฉ:**
   - ููุง ุจููุฉ ููุฏุณูุฉ
   - ุชูุน ุนูู manifold ููุฎูุถ ุงูุฃุจุนุงุฏ
   - ูููู ุชูุซูููุง ุจุฏุงูุฉ ูุณุชูุฑุฉ

2. **SIREN ูุนูู:**
   - sin ุฃูุถู ูู ReLU ููุฐู ุงููููุฉ
   - ุงูุชููุฆุฉ ุงูุตุญูุญุฉ ุถุฑูุฑูุฉ
   - ุงูุชุนูู ูุชุนุฏุฏ ุงูููุงููุณ ูุญุณู ุงููุชุงุฆุฌ

3. **ุงูุฃููุงุท ููุฌูุฏุฉ:**
   - ุทุจูุงุช ูุฎุชููุฉุ ุฃููุงุท ูุดุชุฑูุฉ
   - Q/K/V ููุง ุจูู ูููุฒุฉ
   - ุงูุทุจูุงุช ุงูุนูููุฉ ุฃูุซุฑ ุชุนููุฏุงู

### ูุง ูููู ุจูุงุคู ุนูู ูุฐุง

1. **Transfer Learning:**
   ```
   DNA_BERT_Base โ Fine-tune โ DNA_BERT_Medical
   (ุฃุณุฑุน ูู ุชุฏุฑูุจ ูุงูู!)
   ```

2. **Architecture Search:**
   ```
   ุญูู DNA โ ุงูุชุดู ุงูุฃููุงุท ุงูุฒุงุฆุฏุฉ โ ุญุฐููุง โ ููุฏูู ุฃุตุบุฑ
   ```

3. **Interpretability:**
   ```
   Low freq โ ูุนูู ุนุงู (Grammar)
   High freq โ ุชูุงุตูู ุฏูููุฉ (Style)
   ```

4. **Model Surgery:**
   ```
   ุงุณุชุฎุฑุฌ DNA ูู layer 5 ูู BERT
   + ุฃุถูู ุฅูู layer 3 ูู GPT
   = Hybrid model!
   ```

## ๐ฅ ุงูุชุญุฏู ูู

**ุดุบูู ุงููุธุงูุ ูุงุจุญุซ ุนู:**

1. **ูู ููุงู ููุท ุฏูุฑูุ** (periodic pattern)
   - ุงูุชุญ spectral_analysis.png
   - ุงุจุญุซ ุนู peaks ูุชูุฑุฑุฉ

2. **ูู Attention ู FFN ูุฎุชููุงู ุญูุงูุ**
   - ุงูุชุญ pattern_clustering.png
   - ูุงุฑู ุชุฌูุนุงุชููุง

3. **ุฃู ุทุจูุฉ ุงูุฃุตุนุจ ูุฅุนุงุฏุฉ ุจูุงุฆูุงุ**
   - ุงูุชุญ reconstruction_quality.png
   - ุงูุธุฑ "Error by Layer"

4. **ูู ููููู ุชุญุณูู ุงูู DNAุ**
   - ุฌุฑูุจ adaptive ุจุฏูุงู ูู hierarchical
   - ุฒูุฏ hidden_dim ุฅูู 512
   - ุฃุถู ุทุจูุงุช ุฅุถุงููุฉ

---

**ูุฐุง ููุณ ูุฌุฑุฏ ุถุบุท. ูุฐุง ุงูุชุดุงู.**

</div>
